Index: src/staticnn/training/backward/backprop.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import numpy as np\nfrom typing import Callable\n\n\nArray2D = np.ndarray\nArray1D = np.ndarray\n\n\n\ndef delta_k(d: Array1D, x_k: Array1D) -> Array1D: \n    \"\"\"\n    Funzione che calcola il delta k vettore, quindi una componente fondamentale per calcolare la backprop sull'hidden layer\n\n    Args:\n        d: vettore target\n        x_k: vettore output layer\n        (opzionale) f_deactiv: derivata della funzione di attivazione, nel caso dell'output layer Ã¨ linaere quindi ritorno al x_k\n        x_j: vettore hidden layer\n\n    Ritorna: \n        dk: vettore dei delta k \n    \"\"\"\n    # Inizializza vettore delta k vuoto\n    dk = np.zeros(x_k.size)\n    \n    for kunit in range(x_k.size):\n        print(s)\n        # Aggiorna il vettore deltak con la differenza tra target e previsione * la derivata della funzione lineare quindi l'elemento x_k\n        dk[kunit] = (d[kunit] - x_k[kunit]) * x_k[kunit]\n\n    return dk\n\n\n\ndef delta_j(x_j: Array1D, w_kj: Array2D, delta_k: Array1D, x_k: Array1D, fd: Callable) -> Array1D:\n    \"\"\"\n    Funzione che calcola il vettore delta_j corrispondente all'hiddent layer\n    \n    Args: \n        x_j: vettore hidden layer\n        w_kj: matrice dei pesi tra l'ultimo hidden layer e l'otput layer\n        delta_k: vettore dei delta k \n        x_k: vettore output layer\n        fd: derivata della funzione di attivazione dell'hidden layer da passare\n\n    Ritorna:\n        dj: vettore dei delta j\n    \"\"\"\n    # Inizializza vettore delta j vuoto\n    dj = np.zeros(x_j.size)\n\n    \n    for junit in range(x_j.size):\n\n        sum_parz_w_kj = 0\n        # Somma tra tutti i delta[k] * e il peso corrispondente della matrice w_kj, fissato il nodo j (=junit) di destinazione \n        for k in range(x_k.size):\n            sum_parz_w_kj += (delta_k[k] * w_kj[junit][k])\n        \n        # La Net del nodo j = x_j[junit]\n        dj[junit] = sum_parz_w_kj * fd(x_j[junit])\n    \n    return dj\n        \n\n        \n#def backprop_output(d: Array1D, x_k: Array1D, f_prime: function, w_kj: Array2D, x_j: Array1D,  ):\n    \"\"\"\n    Calcola per ogni k che appartengono all'output layer su ogni nodo appartenente all'hidden layer precedente\n\n    Args:\n        x_k: vettore output layer\n        w_kj: matrice dei pesi tra l'ultimo hidden layer e l'otput layer\n        x_j: vettore hidden layer\n\n    Ritorna:\n        matrice k aggiornata\n    \"\"\"\n\n#def backprop_hidden()
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/staticnn/training/backward/backprop.py b/src/staticnn/training/backward/backprop.py
--- a/src/staticnn/training/backward/backprop.py	(revision 84017f46c0ad9656db27ff9650e0c658b84fd107)
+++ b/src/staticnn/training/backward/backprop.py	(date 1764009314826)
@@ -24,7 +24,6 @@
     dk = np.zeros(x_k.size)
     
     for kunit in range(x_k.size):
-        print(s)
         # Aggiorna il vettore deltak con la differenza tra target e previsione * la derivata della funzione lineare quindi l'elemento x_k
         dk[kunit] = (d[kunit] - x_k[kunit]) * x_k[kunit]
 
Index: scripts/run_training.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># MAIN PROGETTO ML\n\nimport numpy as np\nfrom src.staticnn.model.fixednn import initialize_neuraln\nfrom src.staticnn.training.forward.forward_pass import *\nfrom data.utils.load_data import load_data\nfrom src.staticnn.activationf.sigm import *\nfrom src.staticnn.training.backward.backprop import *\n\n\n# Tipi utili per chiarezza\nArray2D = np.ndarray\nArray1D = np.ndarray\nArray0D = np.ndarray\n\n\ndef run_training() -> None:\n    # X: dataset input (N, 12)\n    # D: dataset target (N, 4)\n    x_i, d = load_data(\"data/training_data/ML-CUP25-TR.csv\")\n\n    x_i = x_i.to_numpy()\n    d = d.to_numpy()\n\n    # ----------------------- INIZIALIZZA NN -------------------------\n    # x: vettore input layer\n    # w: matrice pesi input layer - hidden layer\n    # k: matrice pesi hidden layer - output layer\n    # d: vettori risultati target\n\n    x_i, w_ji, w_kj, d = initialize_neuraln(x_i, d) # <-- Inizializza NN (static)\n    # ----------------------------------------------------------------\n\n    # -------------------- FORWARD PRIMO PATTERN ---------------------    \n    x_j = forward_hidden(x_i[0], w_ji)     # <-- Calcolo valori nodi unico hidden layer\n    x_k = forward_output(x_j, w_kj)        # <-- Calcolo valori output\n    # ----------------------------------------------------------------\n    \n    eta = 1\n    # per un pattern\n    #w_new = w + etha * (-2 * (e[0]) * dsigmaf(x)) \n    \n    print(\"x_k =\", x_k)\n\n\nif __name__ == \"__main__\":\n    run_training()\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/scripts/run_training.py b/scripts/run_training.py
--- a/scripts/run_training.py	(revision 84017f46c0ad9656db27ff9650e0c658b84fd107)
+++ b/scripts/run_training.py	(date 1764085651938)
@@ -7,21 +7,23 @@
 from src.staticnn.activationf.sigm import *
 from src.staticnn.training.backward.backprop import *
 
-
 # Tipi utili per chiarezza
 Array2D = np.ndarray
 Array1D = np.ndarray
 Array0D = np.ndarray
 
 
+
+
+
 def run_training() -> None:
     # X: dataset input (N, 12)
     # D: dataset target (N, 4)
-    x_i, d = load_data("data/training_data/ML-CUP25-TR.csv")
+    x_i, d = load_data("../data/training_data/ML-CUP25-TR.csv")
 
     x_i = x_i.to_numpy()
     d = d.to_numpy()
-
+    eta=0.25
     # ----------------------- INIZIALIZZA NN -------------------------
     # x: vettore input layer
     # w: matrice pesi input layer - hidden layer
@@ -32,11 +34,22 @@
     # ----------------------------------------------------------------
 
     # -------------------- FORWARD PRIMO PATTERN ---------------------    
-    x_j = forward_hidden(x_i[0], w_ji)     # <-- Calcolo valori nodi unico hidden layer
-    x_k = forward_output(x_j, w_kj)        # <-- Calcolo valori output
+
     # ----------------------------------------------------------------
-    
-    eta = 1
+    epochs=500
+    for epoch in range (epochs):
+        x_j = forward_hidden(x_i[epoch], w_ji)  # <-- Calcolo valori nodi unico hidden layer
+        x_k = forward_output(x_j, w_kj)  # <-- Calcolo valori output
+        dk=delta_k(d[epoch], x_k)
+        dj=delta_j(x_j, w_kj, dk, x_k, dsigmaf)
+        for kunit in range (w_kj.shape[1]):
+            for junit in range (w_kj.shape[0]):
+                w_kj[junit][kunit]=w_kj[junit][kunit]+eta*dk[kunit]*x_j[junit]
+        for junit in range (w_ji.shape[1]):
+            for iunit in range (w_ji.shape[0]):
+                w_ji[iunit][junit]=w_ji[iunit][junit]+eta*dj[junit]*x_i[epoch][iunit]
+        print("epoch number ", epoch, " x_k= ", x_k)
+        #print("epoch number ", epoch, " dj= ", dj)
     # per un pattern
     #w_new = w + etha * (-2 * (e[0]) * dsigmaf(x)) 
     
Index: .idea/inspectionProfiles/profiles_settings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/inspectionProfiles/profiles_settings.xml b/.idea/inspectionProfiles/profiles_settings.xml
new file mode 100644
--- /dev/null	(date 1764007272325)
+++ b/.idea/inspectionProfiles/profiles_settings.xml	(date 1764007272325)
@@ -0,0 +1,6 @@
+<component name="InspectionProjectProfileManager">
+  <settings>
+    <option name="USE_PROJECT_PROFILE" value="false" />
+    <version value="1.0" />
+  </settings>
+</component>
\ No newline at end of file
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/misc.xml b/.idea/misc.xml
new file mode 100644
--- /dev/null	(date 1764007272333)
+++ b/.idea/misc.xml	(date 1764007272333)
@@ -0,0 +1,7 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="Black">
+    <option name="sdkName" value="Python 3.14 (MLproject)" />
+  </component>
+  <component name="ProjectRootManager" version="2" project-jdk-name="Python 3.14 (MLproject)" project-jdk-type="Python SDK" />
+</project>
\ No newline at end of file
Index: .idea/vcs.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/vcs.xml b/.idea/vcs.xml
new file mode 100644
--- /dev/null	(date 1764007272343)
+++ b/.idea/vcs.xml	(date 1764007272343)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="VcsDirectoryMappings">
+    <mapping directory="$PROJECT_DIR$" vcs="Git" />
+  </component>
+</project>
\ No newline at end of file
Index: .idea/MLproject.iml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/MLproject.iml b/.idea/MLproject.iml
new file mode 100644
--- /dev/null	(date 1764007272317)
+++ b/.idea/MLproject.iml	(date 1764007272317)
@@ -0,0 +1,7 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module version="4">
+  <component name="PyDocumentationSettings">
+    <option name="format" value="GOOGLE" />
+    <option name="myDocStringFormat" value="Google" />
+  </component>
+</module>
\ No newline at end of file
